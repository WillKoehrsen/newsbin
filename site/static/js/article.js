NodeList.prototype.forEach||(NodeList.prototype.forEach=function(t,e){for(var n=0,a=this.length;n<a;++n)t.call(e,this[n],n,this)});var modal=function(t){t.refs={};for(var e=t.getElementsByTagName("div"),n=0;n<e.length;n++){var a=e[n].getAttribute("ref");a&&(t.refs[a]=e[n])}return handlers={close:function(){for(a in t.refs)t.refs[a].innerHTML="";t.style.display="none"},open:function(e){var n=t.refs;handlers.close(),n.close.innerHTML="Close",n.title.innerHTML=e.name,n.image.innerHTML='<img src="'+e.image+'"/>',e.summary.split("\n\n").forEach(function(t){n.content.innerHTML+="<p>"+t+"</p>"}),n.links.innerHTML+='<a href="https://en.wikipedia.org/wiki/'+e.name+'" target="_blank">on wikipedia</a>',e.slug&&"None"!=e.slug&&(n.links.innerHTML+='<a href="http://www.politifact.com/personalities/'+e.slug+'" target="_blank">on politifact</a>'),data=e.data_table;for(var a=0;a<data.length;a++){var i=data[a];n.data.innerHTML+='<div class="modal-data-item">\t\t\t\t\t\t\t\t\t\t\t<div>'+i.key+"</div>\t\t\t\t\t\t\t\t\t\t\t<div>"+i.value+"</div>\t\t\t\t\t\t\t\t\t\t</div>"}t.style.display="flex"}},handlers}(document.getElementById("js-modal-annotation")),annotations=function(){function t(t){if(n){var e=a.get(this.getAttribute("id"));modal.open(e)}}var e=[],n=!0,a={disable:function(){n=!1;for(var t=document.getElementsByClassName("annotation"),e=0;e<t.length;e++)t[e].classList.remove("highlight")},enable:function(){n=!0;for(var t=document.getElementsByClassName("annotation"),e=0;e<t.length;e++)t[e].classList.add("highlight")},refresh:function(){for(var e=document.getElementsByClassName("annotation"),n=document.getElementById("js-eye-toggle"),a=0;a<e.length;a++){var i=e[a];i.removeEventListener("click",t,!1),i.addEventListener("click",t),n.classList.contains("active-toggle")&&i.classList.add("highlight")}},add:function(t){for(var n=0;n<e.length;n++)if(t.id==e[n].id)return!1;return e.push(t),!0},get:function(t){for(var n=0;n<e.length;n++){var a=e[n];if(t==a.id)return a}},test:function(){console.log(e)}};return a.refresh(),a.enable(),a}();!function(t,e){t&&t.addEventListener("mouseup",function(){var t=window.getSelection();if(!t.isCollapsed&&1==t.rangeCount){var n=t.getRangeAt(0);e&&n&&(e.value=n.toString())}})}(document.getElementById("js-article-content"),document.getElementById("js-add-selection")),function(t){t&&(t.innerHTML=(new Date).getFullYear())}(document.getElementById("js-year")),function(t){t&&(t.id in sessionStorage&&("false"!=sessionStorage.getItem(t.id)?(t.classList.add("active-toggle"),annotations.enable()):(t.classList.remove("active-toggle"),annotations.disable())),t.addEventListener("click",function(){this.classList.toggle("active-toggle")?(annotations.enable(),window.sessionStorage.setItem(this.id,!0)):(annotations.disable(),window.sessionStorage.setItem(this.id,!1))}))}(document.getElementById("js-eye-toggle")),function(t){function e(t,n,a){if("A"!=t.tagName){for(var i="",o=0;o<t.childNodes.length;o++){var s=t.childNodes[o];switch(s.nodeType){case 1:s.innerHTML=e(s,n,a),i+=s.outerHTML;break;case 3:i+=s.nodeValue.replace(n,function(t,e,n){for(var i=null,o=0;o<a.length;o++){var s=a[o];if(s.name==t){i=s;break}}return annotations.add(i),'<span class="annotation" id="'+i.id+'">'+t+"</span>"})}}return i}return t.outerHTML}var n=new XMLHttpRequest;n.onload=function(){if(200==this.status)try{var n=JSON.parse(this.responseText);if(n.length>0){var a=n.sort(function(t,e){return e.name.length-t.name.length||t.name.localeCompare(e.name)});names=[];for(var i=0;i<a.length;i++)names.push(a[i].name);var o=new RegExp(names.join("|"),"g");t.innerHTML=e(t,o,a),annotations.refresh()}}catch(t){console.log(t)}},n.open("GET","/articles/"+DATA.id+"/annotations",!0),n.send()}(document.getElementById("js-article-content"));