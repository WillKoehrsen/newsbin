NodeList.prototype.forEach||(NodeList.prototype.forEach=function(e,t){for(var n=0,a=this.length;n<a;++n)e.call(t,this[n],n,this)});var modal=function(e){e.refs={};for(var t=e.getElementsByTagName("div"),n=0;n<t.length;n++){var a=t[n].getAttribute("ref");a&&(e.refs[a]=t[n])}return handlers={close:function(){for(a in e.refs)e.refs[a].innerHTML="";e.style.display="none"},open:function(t){var n=e.refs;handlers.close(),n.close.innerHTML="Close",n.title.innerHTML=t.name,n.image.innerHTML='<img src="'+t.image+'"/>',t.summary.split("\n\n").forEach(function(e){n.content.innerHTML+="<p>"+e+"</p>"}),n.links.innerHTML+='<a href="https://en.wikipedia.org/wiki/'+t.name+'" target="_blank">on wikipedia</a>',t.slug&&"None"!=t.slug&&(n.links.innerHTML+='<a href="http://www.politifact.com/personalities/'+t.slug+'" target="_blank">on politifact</a>'),data=t.data_table;for(var a=0;a<data.length;a++){var i=data[a];n.data.innerHTML+='<div class="modal-data-item">\t\t\t\t\t\t\t\t\t\t\t<div>'+i.key+"</div>\t\t\t\t\t\t\t\t\t\t\t<div>"+i.value+"</div>\t\t\t\t\t\t\t\t\t\t</div>"}e.style.display="flex"}},handlers}(document.getElementById("js-modal-annotation")),annotations=function(){function e(e){if(n){var t=a.get(this.getAttribute("id"));modal.open(t)}}var t=[],n=!0,a={disable:function(){n=!1;for(var e=document.getElementsByClassName("annotation"),t=0;t<e.length;t++)e[t].classList.remove("highlight")},enable:function(){n=!0;for(var e=document.getElementsByClassName("annotation"),t=0;t<e.length;t++)e[t].classList.add("highlight")},refresh:function(){for(var t=document.getElementsByClassName("annotation"),n=document.getElementById("js-eye-toggle"),a=0;a<t.length;a++){var i=t[a];i.removeEventListener("click",e,!1),i.addEventListener("click",e),n.classList.contains("active-toggle")&&i.classList.add("highlight")}},add:function(e){for(var n=0;n<t.length;n++)if(e.id==t[n].id)return!1;return t.push(e),!0},get:function(e){for(var n=0;n<t.length;n++){var a=t[n];if(e==a.id)return a}},test:function(){console.log(t)}};return a.refresh(),a.enable(),a}();!function(e,t){e&&e.addEventListener("mouseup",function(){var e=window.getSelection();if(!e.isCollapsed&&1==e.rangeCount){var n=e.getRangeAt(0);t&&n&&(t.value=n.toString())}})}(document.getElementById("js-article-content"),document.getElementById("js-add-selection")),function(e){e&&(e.innerHTML=(new Date).getFullYear())}(document.getElementById("js-year")),function(e,t){e&&t&&(e.id in sessionStorage&&("false"!=sessionStorage.getItem(e.id)?(e.classList.add("active-toggle"),annotations.enable()):(e.classList.remove("active-toggle"),annotations.disable())),t.addEventListener("click",function(){e.classList.toggle("active-toggle")?(annotations.enable(),window.sessionStorage.setItem(e.id,!0)):(annotations.disable(),window.sessionStorage.setItem(e.id,!1))}))}(document.getElementById("js-eye-toggle"),document.getElementById("js-eye-btn")),function(e){function t(e,n,a){if("A"!=e.tagName){for(var i="",o=0;o<e.childNodes.length;o++){var s=e.childNodes[o];switch(s.nodeType){case 1:s.innerHTML=t(s,n,a),i+=s.outerHTML;break;case 3:i+=s.nodeValue.replace(n,function(e,t,n){for(var i=null,o=0;o<a.length;o++){var s=a[o];if(s.name==e){i=s;break}}return annotations.add(i),'<span class="annotation" id="'+i.id+'">'+e+"</span>"})}}return i}return e.outerHTML}var n=new XMLHttpRequest;n.onload=function(){if(200==this.status)try{var n=JSON.parse(this.responseText).sort(function(e,t){return t.name.length-e.name.length||e.name.localeCompare(t.name)});names=[];for(var a=0;a<n.length;a++)names.push(n[a].name);var i=new RegExp(names.join("|"),"g");e.innerHTML=t(e,i,n),annotations.refresh()}catch(e){console.log(e)}},n.open("GET","/articles/"+DATA.id+"/annotations",!0),n.send()}(document.getElementById("js-article-content"));