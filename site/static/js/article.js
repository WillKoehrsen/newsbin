NodeList.prototype.forEach||(NodeList.prototype.forEach=function(t,e){for(var n=0,a=this.length;n<a;++n)t.call(e,this[n],n,this)});var modal=function(t){t.refs={};for(var e=t.getElementsByTagName("div"),n=0;n<e.length;n++){var a=e[n].getAttribute("ref");a&&(t.refs[a]=e[n])}return handlers={close:function(){for(a in t.refs)t.refs[a].innerHTML="";t.style.display="none"},open:function(e){var n=new XMLHttpRequest,a=t.refs;n.onload=function(){if(200==this.status){handlers.close();var e=JSON.parse(this.responseText);a.close.innerHTML="Close",a.title.innerHTML=e.name,a.image.innerHTML='<img src="'+e.image+'"/>',e.summary.split("\n\n").forEach(function(t){a.content.innerHTML+="<p>"+t+"</p>"}),a.links.innerHTML+='<a href="https://en.wikipedia.org/wiki/'+e.name+'" target="_blank">on wikipedia</a>',e.slug&&(a.links.innerHTML+='<a href="http://www.politifact.com/personalities/'+e.slug+'" target="_blank">on politifact</a>'),e.data_table.forEach(function(t){a.data.innerHTML+='<div class="modal-data-item" tooltip="'+t.tooltip+'">\t\t\t\t\t\t\t\t\t\t\t\t\t<div>'+t.key+"</div>\t\t\t\t\t\t\t\t\t\t\t\t\t<div>"+t.value+"</div>\t\t\t\t\t\t\t\t\t\t\t\t</div>",tooltips.add(a.data.lastChild)}),t.style.display="flex"}else console.log(this.status)},n.open("GET","/annotations?name="+e,!0),n.send()}},handlers}(document.getElementById("js-modal-annotation")),annotations=function(){function t(t){e&&modal.open(this.getAttribute("name"))}var e=!0,n={disable:function(){e=!1;for(var t=document.getElementsByClassName("annotation"),n=0;n<t.length;n++)t[n].classList.remove("highlight")},enable:function(){e=!0;for(var t=document.getElementsByClassName("annotation"),n=0;n<t.length;n++)t[n].classList.add("highlight")},refresh:function(){for(var e=document.getElementsByClassName("annotation"),n=document.getElementById("eye-toggle"),a=0;a<e.length;a++){var i=e[a];i.removeEventListener("click",t,!1),i.addEventListener("click",t),n.classList.contains("active-toggle")&&i.classList.add("highlight")}}};return n.refresh(),n.enable(),n}();!function(t,e){t&&t.addEventListener("mouseup",function(){var t=window.getSelection();if(!t.isCollapsed&&1==t.rangeCount){var n=t.getRangeAt(0);e&&n&&(e.value=n.toString())}})}(document.getElementById("js-article-content"),document.getElementById("js-add-selection")),function(t){t&&(t.innerHTML=(new Date).getFullYear())}(document.getElementById("js-year")),function(t,e){var n=[];[].push.apply(n,t.getElementsByTagName("div"));var a={open_menu:function(){e.classList.add("open")},close_menu:function(){e.classList.remove("open")}};n.forEach(function(t){t.addEventListener("click",function(t){this.classList.contains("current")||(n.forEach(function(t){t.classList.remove("current")}),this.classList.add("current"),a[this.getAttribute("run")]())})})}(document.getElementById("js-mobile-menu"),document.getElementById("js-menu")),function(t){t&&(t.id in sessionStorage&&("false"!=sessionStorage.getItem(t.id)?(t.classList.add("active-toggle"),annotations.enable()):(t.classList.remove("active-toggle"),annotations.disable())),t.addEventListener("click",function(){this.classList.toggle("active-toggle")?(annotations.enable(),window.sessionStorage.setItem(this.id,!0)):(annotations.disable(),window.sessionStorage.setItem(this.id,!1))}))}(document.getElementById("eye-toggle")),function(t){function e(t,n){if("A"!=t.tagName){for(var a="",i=0;i<t.childNodes.length;i++){var s=t.childNodes[i];switch(s.nodeType){case 1:s.innerHTML=e(s,n),a+=s.outerHTML;break;case 3:var o=new RegExp(n.join("|"),"g");a+=s.nodeValue.replace(o,function(t,e,n){return'<span class="annotation" name="'+t+'">'+t+"</span>"})}}return a}return t.outerHTML}var n=new XMLHttpRequest;n.onload=function(){if(200==this.status)try{var n=JSON.parse(this.responseText);values=n,t.innerHTML=e(t,values),annotations.refresh()}catch(t){console.log(t)}},n.open("GET","/article/"+DATA.id+"/annotate",!0),n.send()}(document.getElementById("js-article-content"));